{
  "schema": "// ElderCare Prisma Schema\n// Comprehensive database schema for the care services platform\n\ngenerator client {\n  provider = \"prisma-client-js\"\n}\n\ndatasource db {\n  provider = \"postgresql\"\n}\n\n// ============================================\n// USER & AUTHENTICATION\n// ============================================\n\nmodel User {\n  id        String   @id @default(uuid())\n  email     String   @unique\n  password  String\n  name      String\n  avatar    String?\n  role      UserRole @default(USER)\n  isActive  Boolean  @default(true)\n  createdAt DateTime @default(now())\n  updatedAt DateTime @updatedAt\n\n  // Relations\n  adminProfile      Admin?\n  clientProfile     Client?\n  specialistProfile Specialist?\n  sessions          Session[]\n  notifications     Notification[]\n\n  @@map(\"users\")\n}\n\nenum UserRole {\n  USER\n  ADMIN\n  SPECIALIST\n  CLIENT\n}\n\nmodel Session {\n  id        String   @id @default(uuid())\n  userId    String\n  token     String   @unique\n  expiresAt DateTime\n  createdAt DateTime @default(now())\n\n  user User @relation(fields: [userId], references: [id], onDelete: Cascade)\n\n  @@index([userId])\n  @@map(\"sessions\")\n}\n\n// ============================================\n// ADMIN\n// ============================================\n\nmodel Admin {\n  id        String   @id @default(uuid())\n  userId    String   @unique\n  createdAt DateTime @default(now())\n\n  user User @relation(fields: [userId], references: [id], onDelete: Cascade)\n\n  @@map(\"admins\")\n}\n\n// ============================================\n// CLIENT (Service Requesters)\n// ============================================\n\nmodel Client {\n  id        String   @id @default(uuid())\n  userId    String?  @unique\n  phone     String   @unique\n  name      String?\n  city      String?  // Default city from profile\n  address   String?  // Default address from profile\n  createdAt DateTime @default(now())\n  updatedAt DateTime @updatedAt\n\n  // Relations\n  user    User?    @relation(fields: [userId], references: [id], onDelete: SetNull)\n  orders  Order[]\n  reviews Review[]\n\n  @@map(\"clients\")\n}\n\n// ============================================\n// SPECIALIST (Care Workers)\n// ============================================\n\nmodel Specialist {\n  id           String   @id @default(uuid())\n  userId       String?  @unique\n  phone        String   @unique\n  name         String\n  email        String?\n  avatar       String?\n  isActive     Boolean  @default(true)\n  rating       Float    @default(0)\n  reviewCount  Int      @default(0)\n  createdAt    DateTime @default(now())\n  updatedAt    DateTime @updatedAt\n\n  // Relations\n  user            User?                    @relation(fields: [userId], references: [id], onDelete: SetNull)\n  serviceTypes    SpecialistServiceType[]\n  cities          SpecialistCity[]\n  availabilities  Availability[]\n  orders          Order[]\n\n  @@map(\"specialists\")\n}\n\n// Specialist can provide multiple service types\nmodel SpecialistServiceType {\n  id           String @id @default(uuid())\n  specialistId String\n  serviceId    String\n\n  specialist Specialist @relation(fields: [specialistId], references: [id], onDelete: Cascade)\n  service    Service    @relation(fields: [serviceId], references: [id], onDelete: Cascade)\n\n  @@unique([specialistId, serviceId])\n  @@map(\"specialist_service_types\")\n}\n\n// Specialist can work in multiple cities\nmodel SpecialistCity {\n  id           String @id @default(uuid())\n  specialistId String\n  cityId       String\n\n  specialist Specialist @relation(fields: [specialistId], references: [id], onDelete: Cascade)\n  city       City       @relation(fields: [cityId], references: [id], onDelete: Cascade)\n\n  @@unique([specialistId, cityId])\n  @@map(\"specialist_cities\")\n}\n\n// ============================================\n// SERVICE TYPES\n// ============================================\n\nmodel Service {\n  id          String          @id @default(uuid())\n  code        String          @unique // e.g., \"caregiver\", \"nurse\"\n  name        String\n  description String\n  category    ServiceCategory\n  icon        String?\n  isActive    Boolean         @default(true)\n  sortOrder   Int             @default(0)\n  createdAt   DateTime        @default(now())\n  updatedAt   DateTime        @updatedAt\n\n  // Relations\n  specialists SpecialistServiceType[]\n  orders      Order[]\n\n  @@map(\"services\")\n}\n\nenum ServiceCategory {\n  CARE\n  MEDICAL\n  HOUSEHOLD\n  TRANSPORT\n}\n\n// ============================================\n// CITIES / AREAS\n// ============================================\n\nmodel City {\n  id        String   @id @default(uuid())\n  name      String   @unique\n  region    String?\n  isActive  Boolean  @default(true)\n  sortOrder Int      @default(0)\n  createdAt DateTime @default(now())\n\n  // Relations\n  specialists SpecialistCity[]\n  orders      Order[]\n\n  @@map(\"cities\")\n}\n\n// ============================================\n// AVAILABILITY\n// ============================================\n\nmodel Availability {\n  id           String   @id @default(uuid())\n  specialistId String\n  date         DateTime @db.Date\n  startTime    String   // \"08:00\" format\n  endTime      String   // \"18:00\" format\n  isBooked     Boolean  @default(false)\n  createdAt    DateTime @default(now())\n  updatedAt    DateTime @updatedAt\n\n  specialist Specialist @relation(fields: [specialistId], references: [id], onDelete: Cascade)\n\n  @@index([specialistId, date])\n  @@index([date, isBooked])\n  @@map(\"availabilities\")\n}\n\n// ============================================\n// ORDERS\n// ============================================\n\nmodel Order {\n  id           String      @id @default(uuid())\n  orderNumber  String      @unique // Human-readable order number\n  clientId     String\n  serviceId    String\n  specialistId String?\n  cityId       String\n\n  // Client info snapshot\n  clientPhone  String\n  clientName   String?\n\n  // Location\n  address      String\n  addressNotes String?\n\n  // Schedule\n  date         DateTime    @db.Date\n  startTime    String      // \"09:00\" format\n  duration     Int?        // Duration in minutes\n\n  // Status\n  status       OrderStatus @default(CREATED)\n  notes        String?\n\n  // Actual times\n  actualStart  DateTime?\n  actualEnd    DateTime?\n\n  // Pricing\n  estimatedPrice Float?\n  finalPrice     Float?\n\n  // Payment info (filled by admin after completion)\n  paidAmount    Float?\n  paidAt        DateTime?\n  paymentNotes  String?\n\n  // Timestamps\n  createdAt    DateTime    @default(now())\n  updatedAt    DateTime    @updatedAt\n  cancelledAt  DateTime?\n  completedAt  DateTime?\n\n  // Relations\n  client     Client      @relation(fields: [clientId], references: [id])\n  service    Service     @relation(fields: [serviceId], references: [id])\n  specialist Specialist? @relation(fields: [specialistId], references: [id])\n  city       City        @relation(fields: [cityId], references: [id])\n  review     Review?\n  events     OrderEvent[]\n\n  @@index([clientId])\n  @@index([specialistId])\n  @@index([status])\n  @@index([date])\n  @@index([createdAt])\n  @@map(\"orders\")\n}\n\nenum OrderStatus {\n  CREATED\n  REVIEWING\n  ASSIGNED\n  ON_WAY\n  IN_PROGRESS\n  COMPLETED\n  PAID\n  CANCELLED\n}\n\n// Order status change history\nmodel OrderEvent {\n  id        String      @id @default(uuid())\n  orderId   String\n  status    OrderStatus\n  note      String?\n  createdAt DateTime    @default(now())\n  createdBy String?     // User ID who made the change\n\n  order Order @relation(fields: [orderId], references: [id], onDelete: Cascade)\n\n  @@index([orderId, createdAt])\n  @@map(\"order_events\")\n}\n\n// ============================================\n// REVIEWS\n// ============================================\n\nmodel Review {\n  id        String   @id @default(uuid())\n  orderId   String   @unique\n  clientId  String\n  rating    Int      // 1-5\n  comment   String?\n  createdAt DateTime @default(now())\n\n  order  Order  @relation(fields: [orderId], references: [id], onDelete: Cascade)\n  client Client @relation(fields: [clientId], references: [id])\n\n  @@index([clientId])\n  @@map(\"reviews\")\n}\n\n// ============================================\n// NOTIFICATIONS\n// ============================================\n\nmodel Notification {\n  id        String           @id @default(uuid())\n  userId    String\n  type      NotificationType\n  title     String\n  message   String\n  data      Json?            // Additional payload\n  isRead    Boolean          @default(false)\n  createdAt DateTime         @default(now())\n\n  user User @relation(fields: [userId], references: [id], onDelete: Cascade)\n\n  @@index([userId, isRead])\n  @@index([createdAt])\n  @@map(\"notifications\")\n}\n\nenum NotificationType {\n  ORDER_CREATED\n  ORDER_ASSIGNED\n  ORDER_STATUS_CHANGED\n  ORDER_PAID\n  SHIFT_STARTED\n  SHIFT_ENDED\n  REVIEW_RECEIVED\n  SYSTEM\n}\n\n// ============================================\n// SETTINGS & CONFIGURATION\n// ============================================\n\nmodel Setting {\n  id        String   @id @default(uuid())\n  key       String   @unique\n  value     Json\n  createdAt DateTime @default(now())\n  updatedAt DateTime @updatedAt\n\n  @@map(\"settings\")\n}\n\n// OTP codes for phone authentication\nmodel OtpCode {\n  id        String   @id @default(uuid())\n  phone     String\n  code      String\n  expiresAt DateTime\n  isUsed    Boolean  @default(false)\n  createdAt DateTime @default(now())\n\n  @@index([phone, code])\n  @@index([expiresAt])\n  @@map(\"otp_codes\")\n}\n",
  "metadata": {
    "path": "src/prisma/schema.prisma",
    "size": 9318,
    "modified": "2025-12-14T18:37:13.301Z"
  }
}